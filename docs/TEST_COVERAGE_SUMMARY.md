# Test Coverage Summary

> **Last Updated:** Generated by `scripts/analyze-test-coverage.mjs`

## Overall Coverage

| Category | Coverage | Tested | Total |
|----------|----------|--------|-------|
| **GraphQL Mutations** | **87%** | 132 | 152 |
| **GraphQL Queries** | **68%** | 46 | 68 |
| **GraphQL Total** | **81%** | 178 | 220 |
| **REST Endpoints** | **45%** | 5 | 11 |

## Critical Gaps

### Payment Webhooks Missing Tests
- ❌ **Stripe webhook** (`POST /payment/stripe`) - Most popular payment provider
- ❌ **Saferpay webhook** (`GET /payment/saferpay/webhook`)

### Ticketing Endpoints (0% coverage)
- ❌ Apple Wallet (`/rest/apple-wallet`)
- ❌ Google Wallet (`/rest/google-wallet`)
- ❌ PDF Printing (`/rest/print_tickets`)

### File Storage
- ❌ GridFS (`/gridfs/:directoryName/:fileName`)

### High-Priority GraphQL Operations (20 untested mutations)
- **Web3 & WebAuthn** (5 operations): Modern authentication not covered
- **Cart Setup** (4 operations): Payment & delivery configuration
- **Admin Operations**: User impersonation, user removal
- **Analytics**: Event & work statistics queries
- **Push Notifications** (2 operations)
- **Token Management** (2 operations)

## What's Well Tested

### Payment Webhooks (62% coverage)
✅ Datatrans, PostFinance Checkout, Apple IAP, Payrexx, Cryptopay

### Core E-Commerce (85%+ coverage)
✅ Products, Orders, Cart, Enrollments, Quotations, Reviews, Bookmarks

### Provider Management (100% coverage)
✅ Delivery, Payment, Warehousing providers (CRUD operations)

### User Management (80%+ coverage)
✅ Authentication, registration, profile management, roles

### Assortments & Filters (95%+ coverage)
✅ Complete CRUD operations, media, links, products

## Recommendations Priority

### P0 - Critical for Production
1. Add Stripe webhook integration tests
2. Add basic ticketing endpoint tests (Apple/Google Wallet)

### P1 - Important for Security
3. Test Web3 authentication flows
4. Test WebAuthn authentication flows
5. Test user impersonation (admin feature)

### P2 - Quality Improvements
6. Test analytics/statistics queries
7. Test push notification operations
8. Test GridFS file storage endpoints
9. Test cart payment/delivery setup mutations

## How to Update

Run the analysis script to regenerate the full report:

```bash
node scripts/analyze-test-coverage.mjs > docs/TEST_COVERAGE_ANALYSIS.md
```

See `scripts/README-test-coverage.md` for more details.

## Full Report

For detailed operation-by-operation coverage, see [TEST_COVERAGE_ANALYSIS.md](./TEST_COVERAGE_ANALYSIS.md).
